<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Python bindings for Bond</title>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
  body {
      line-height: 1.5; 
      font-family: Helvetica, Arial, sans-serif; 
      color: #333333;
      font-size: 1em;
  }
  code {
      font-size: 1em;
      font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace, serif;
  }
  td.lineNumbers { width: 40px; }
  div#all {
    max-width: 1120px;
    background-color: #ffffff;
    margin: 0 auto;
    padding: 25px;
    overflow: auto;
  }
  code > span.kw { color: #204a87; font-weight: normal; } /* Keyword */  
  code > span.co { color: #4E9A06; font-style: normal; }
  code > span.st { color: #8A0303; font-style: normal; }
  code > span.cf { color: #204a87; font-weight: normal; } /* ControlFlow */
  code > span.op { color: #000000; font-weight: normal; } /* Operator */
  code > span.pp { color: #8f5902; font-style: normal; } /* Preprocessor */
  code > span.ex { } /* Extension */
  code > span.at { color: #c4a000; } /* Attribute */
  code > span.do { color: #8f5902; font-weight: normal; font-style: normal; } /* Documentation */
  code > span.an { color: #8f5902; font-weight: normal; font-style: normal; } /* Annotation */
  code > span.cv { color: #8f5902; font-weight: normal; font-style: normal; } /* CommentVar */
  code > span.in { color: #8f5902; font-weight: normal; font-style: normal; } /* Information */

  h1, h2, h3, h4, h5, h6 {
    font-weight: normal;
    border-bottom: 1px solid black;
  }

  div.sourceCode {
    overflow-x: auto;
    max-height: 620px;
  }

  table.sourceCode { 
    line-height: 120%;
  } 

  #toc {
    width: 300px; 
    position:fixed;
    overflow: auto;
    height: 95%;
  }

  #main {
    margin-left: 320px;  
    margin-rigth: auto;
    max-width: 800px;
  }
  a {
    text-decoration: none;
  }
  #toc a:visited {
    color: #99c;
  }
  #main a:visited {
    color: #36c;
  }
  a:link {
    color: #36c;
  }
  @media screen and (max-width: 979px){
  #main {
    margin-left: auto;
    margin-right: auto;
  }
  #toc {
    left: -300px; 
  }
  }
  </style>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58775439-1', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body>
<nav id="TOC"></nav>
<div id="all">
<div id="toc">
<ul>
<li><a href="#about">About</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#basic-example">Basic example</a></li>
<li><a href="#building-extensions">Building extensions</a></li>
<li><a href="#exposing-types">Exposing types</a><ul>
<li><a href="#structs">Structs</a></li>
<li><a href="#enums">Enums</a></li>
<li><a href="#containers">Containers</a></li>
<li><a href="#blob">Blob</a></li>
<li><a href="#nullable-and-nothing">Nullable and <code>nothing</code></a></li>
<li><a href="#generics">Generics</a></li>
</ul></li>
<li><a href="#exposed-apis">Exposed APIs</a></li>
<li><a href="#references">References</a><ul>
<li><a href="#bond-compiler-referencecompiler"><a href="compiler.html">Bond compiler reference</a></a></li>
<li><a href="#c-users-manualbond_cpp"><a href="bond_cpp.html">C++ User’s Manual</a></a></li>
<li><a href="#c-users-manualbond_cs"><a href="bond_cs.html">C# User’s Manual</a></a></li>
<li><a href="#boost-pythonboost_python"><a href="http://www.boost.org/doc/libs/1_54_0/libs/python/doc/index.html">Boost Python</a></a></li>
</ul></li>
</ul>
</div>
<div id="main">
<div id="header">    
<h1 class="title">Python bindings for Bond</h1>
</div>
<p><img src="data:image/png;base64,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" alt="The Bond logo: a stylized glue gun" /><br />
</p>
<h1 id="about">About</h1>
<p>Bond is an extensible framework for working with schematized data. It is suitable for scenarios ranging from service communications to Big Data storage and processing.</p>
<p>Bond defines a rich type system and schema versioning rules which allow forward and backward compatibility. The core Bond features include high performance serialization/deserialization and a very powerful, generic data transform mechanism. The framework is highly extensible via pluggable serialization protocols, data streams, user defined type aliases and more.</p>
<p>By design Bond is language and platform independent and is currently supported for C++, C#, and Python on Linux, OS X and Windows.</p>
<p>Bond is published on GitHub at <a href="https://github.com/Microsoft/bond/" class="uri">https://github.com/Microsoft/bond/</a>.</p>
<h1 id="introduction">Introduction</h1>
<p>The Python support is implemented as a library for building C++ extensions exposing Bond generated types and associated APIs to Python.</p>
<h1 id="basic-example">Basic example</h1>
<p>We start with defining a data schema using Bond idl language:</p>
<div class="sourceCode"><table class="sourceCode cpp numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
</pre></td><td class="sourceCode"><pre><code class="sourceCode cpp"><span class="kw">namespace</span> example

<span class="kw">struct</span> Record
{
    <span class="dv">0</span>: string          name;
    <span class="dv">1</span>: vector&lt;<span class="dt">double</span>&gt;  items;
};</code></pre></td></tr></table></div>
<p>In order to use the schema in a Python program we need to implement a Python extension that exposes types representing the schema. The first step is to generate Bond C++ bindings for the schema using the Bond compiler:</p>
<div class="sourceCode"><table class="sourceCode cpp numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
</pre></td><td class="sourceCode"><pre><code class="sourceCode cpp">gbc c++ example.bond</code></pre></td></tr></table></div>
<p>With the generated C++ code (<code>example_reflection.h</code> in this case) implementing the Python extension is as simple as specifying which structs we want to expose to Python:</p>
<div class="sourceCode"><table class="sourceCode cpp numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="sourceCode"><pre><code class="sourceCode cpp"><span class="pp">#include </span><span class="im">&quot;example_reflection.h&quot;</span>
<span class="pp">#include </span><span class="im">&lt;bond/python/struct.h&gt;</span>

<span class="ex">BOOST_</span>PYTHON_MODULE(example)
{
    bond::python::<span class="va">struct_</span>&lt;example::Record&gt;()
        .def();
} </code></pre></td></tr></table></div>
<p>Finally, we can import the extension as a module that can be used in a Python program:</p>
<div class="sourceCode"><table class="sourceCode python numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="sourceCode"><pre><code class="sourceCode python">    <span class="im">import</span> example

    src <span class="op">=</span> example.Record()

    src.name <span class="op">=</span> <span class="st">&quot;test&quot;</span>
    src.items <span class="op">=</span> [<span class="fl">3.14</span>, <span class="fl">6.28</span>]

    data <span class="op">=</span> example.Serialize(src)

    dst <span class="op">=</span> example.Record()
    example.Deserialize(data, dst)</code></pre></td></tr></table></div>
<h1 id="building-extensions">Building extensions</h1>
<p>Python extensions are simply shared libraries with the same file name as the module name. On Windows the extension should have .pyd file extension. Bond extensions depend on <a href="http://www.boost.org/doc/libs/1_54_0/libs/python/doc/index.html">Boost Python</a> library, and thus need to be linked with both the Boost Python library and the Python library. Refer to <a href="http://www.boost.org/doc/libs/1_54_0/libs/python/doc/building.html">Boost documentation</a> for details.</p>
<h1 id="exposing-types">Exposing types</h1>
<h2 id="structs">Structs</h2>
<p>Structs generated from Bond schemas can be exposed by calling <code>def</code> method of the <code>bond::python::struct_</code> class template within a <code>BOOST_PYTHON_MODULE</code> block. The template takes one parameter: the C++ struct to be exposed. The <code>def</code> method has two overloads. When <code>def</code> if called without any arguments the struct is exposed using unqualified name. To expose a struct using the fully qualified name, the <code>def</code> method can be called with <code>bond::qualified_name</code> as argument.</p>
<p>If a struct is exposed, all of its dependencies are implicitly exposed as well and often don’t need to be exposed explicitly. Note however that <a href="#exposed-apis">APIs</a> are defined only for explicitly exposed types. Implicitly exposed types always use unqualified name. If it is necessary to use the qualified name for a struct, it should be explicitly exposed <em>before</em> its dependent structs.</p>
<div class="sourceCode"><table class="sourceCode cpp numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="sourceCode"><pre><code class="sourceCode cpp"><span class="ex">BOOST_</span>PYTHON_MODULE(example)
{
    <span class="kw">using</span> <span class="kw">namespace</span> bond::python;

    <span class="va">struct_</span>&lt;example::Nested&gt;()
        .def(bond::qualified_name);

    <span class="va">struct_</span>&lt;example::Example&gt;()
        .def();
}</code></pre></td></tr></table></div>
<h2 id="enums">Enums</h2>
<p>Since enums are almost always used in exposed structs, usually it is not necessary to expose them explicitly. One common exception, as was the case with structs, is when we want to explicitly expose an enum using the qualified name.</p>
<p>Enumerator types generated from Bond schema can be exposed by calling <code>def</code> method of the <code>bond::python::enum_</code> class template from a <code>BOOST_PYTHON_MODULE</code> block. The template takes one parameter: the C++ enum to be exposed. The <code>def</code> method has two overloads. When <code>def</code> is called without any arguments the enum is exposed using unqualified name. To expose an enum using the fully qualified name, the <code>def</code> method can be called with <code>bond::qualified_name</code> as argument.</p>
<div class="sourceCode"><table class="sourceCode cpp numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="sourceCode"><pre><code class="sourceCode cpp"><span class="ex">BOOST_</span>PYTHON_MODULE(example)
{
    <span class="kw">using</span> <span class="kw">namespace</span> bond::python;

    <span class="va">enum_</span>&lt;example::Colors&gt;()
        .def(bond::qualified_name);

    <span class="va">struct_</span>&lt;example::Example&gt;()
        .def();
}</code></pre></td></tr></table></div>
<h2 id="containers">Containers</h2>
<p>Any container classes used in exposed schema structs are automatically exposed to Python. The exposed types behave just like Python built-in equivalent containers, supporting Python style indexing, including slices and negative indices, list/set/dictionary comprehension as well as many of the built-in functions and operations like <code>len()</code>, <code>del</code> and <code>in</code>. Built-in container objects also are implicitly convertible to containers exposed by Bond.</p>
<p>There is a noteworthy difference between Bond <code>map</code> and Python <code>dictionary</code>: iterating over elements of a <code>map</code> doesn’t yield tuples <code>(key, value)</code> but instead objects with two methods: <code>key()</code> and <code>data()</code>.</p>
<h2 id="blob">Blob</h2>
<p>Bond <code>blob</code> is represented as either a string object in Python2 or a bytes object in Python3. Initializing a <code>blob</code> from a Python object does not involve a memory copy; instead, the reference count on the underlying Python object is increased.</p>
<h2 id="nullable-and-nothing">Nullable and <code>nothing</code></h2>
<p>The <code>null</code> value for nullable types and default value of <code>nothing</code> are both mapped to the Python <code>None</code> object. For example, given the schema:</p>
<div class="sourceCode"><table class="sourceCode cpp numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
</pre></td><td class="sourceCode"><pre><code class="sourceCode cpp"><span class="kw">struct</span> Record
{
    <span class="dv">0</span>: int32 x = nothing;
    <span class="dv">1</span>: nullable&lt;string&gt; s;
}</code></pre></td></tr></table></div>
<p>We can write the following Python program:</p>
<div class="sourceCode"><table class="sourceCode python numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="sourceCode"><pre><code class="sourceCode python">    obj <span class="op">=</span> example.Record()

    <span class="cf">assert</span>(obj.x <span class="kw">is</span> <span class="va">None</span>)
    <span class="cf">assert</span>(obj.s <span class="kw">is</span> <span class="va">None</span>)

    x <span class="op">=</span> <span class="dv">100</span>
    s <span class="op">=</span> <span class="st">&quot;test&quot;</span>

    <span class="cf">assert</span>(obj.x <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>)
    <span class="cf">assert</span>(obj.s <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>)</code></pre></td></tr></table></div>
<h2 id="generics">Generics</h2>
<p>While generic Bond schemas can not be instantiated from within a Python program, specific instances of generic schemas can be used like any other concrete structs. In fact any instances of a generic schema used within exposed structs are also implicitly exposed, just like any other nested struct.</p>
<div class="sourceCode"><table class="sourceCode cpp numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="sourceCode"><pre><code class="sourceCode cpp"><span class="kw">namespace</span> generic

<span class="kw">struct</span> Generic&lt;T&gt;
{
    <span class="dv">0</span>: T field;
}

<span class="kw">struct</span> Example
{
    <span class="dv">0</span>: Generic&lt;string&gt; field;
}</code></pre></td></tr></table></div>
<p>For example, an extension exposing the struct <code>Example</code> will also automatically expose the instance <code>Generic&lt;string&gt;</code>. Additionally, we can explicitly expose other instances of <code>Generic&lt;T&gt;</code>:</p>
<div class="sourceCode"><table class="sourceCode cpp numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="sourceCode"><pre><code class="sourceCode cpp"><span class="ex">BOOST_</span>PYTHON_MODULE(example)
{
    <span class="co">// Expose Example and implicitly Generic&lt;string&gt;</span>
    bond::python::<span class="va">struct_</span>&lt;generic.Example&gt;()
        .def();

    <span class="co">// Explicitly expose Generic&lt;bond.GUID&gt;</span>
    bond::python::<span class="va">struct_</span>&lt;generic.Generic&lt;bond::GUID&gt; &gt;()
        .def();
}</code></pre></td></tr></table></div>
<p>The name of a generic schema instance is converted to a valid Python identifier by replacing all non-alphanumeric characters with an underscore. The names of type parameters that are Bond-defined structs are used in their fully qualified form. For example, using the extension defined above we can use the following types:</p>
<div class="sourceCode"><table class="sourceCode python numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
</pre></td><td class="sourceCode"><pre><code class="sourceCode python">    <span class="im">import</span> example

    <span class="co"># The instance Generic&lt;string&gt;</span>
    obj1 <span class="op">=</span> example.Generic_string_()

    <span class="co"># The instance Generic&lt;bond.GUID&gt;</span>
    obj2 <span class="op">=</span> example.Generic_bond_GUID_()</code></pre></td></tr></table></div>
<h1 id="exposed-apis">Exposed APIs</h1>
<p>For every exposed schema struct Bond exposes appropriate overloads of the following API functions:</p>
<ul>
<li><p><code>Serialize</code> and <code>Marshal</code></p>
<p>Take as an argument instance of Bond struct and return a Python string with serialized/marshaled data.</p></li>
<li><p><code>Deserialize</code> and <code>Unmarshal</code></p>
<p>Take two arguments, a Python string object containing serialized/marshaled data and a reference to a Bond struct to which the data should be deserialized.</p></li>
<li><p><code>GetRuntimeSchema</code></p>
<p>Takes as an argument a Bond struct and returns an instance of SchemaDef for that struct.</p></li>
</ul>
<p>The <code>Serialize</code>, <code>Deserialize</code> and <code>Marshal</code> APIs use the Compact Binary protocol by default but they also take an optional argument of type <code>bond::ProtocolType</code> to specify a different protocol.</p>
<p>The <code>Deserialize</code> and <code>Unmarshal</code> APIs take an optional argument of type <code>SchemaDef</code> to specify the schema of the serialized data.</p>
<div class="sourceCode"><table class="sourceCode python numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="sourceCode"><pre><code class="sourceCode python">    <span class="im">import</span> example

    obj <span class="op">=</span> example.Record()

    <span class="co"># serialize to Compact Binary</span>
    data <span class="op">=</span> example.Serialize(obj)

    <span class="co"># serialize to JSON</span>
    json <span class="op">=</span> example.Serialize(obj, example.ProtocolType.SIMPLE_JSON_PROTOCOL)

    <span class="co"># marshal schema to Compact Binary</span>
    data <span class="op">=</span> example.Marshal(example.GetRuntimeSchema(obj))

    <span class="co"># unmarshal SchemaDef</span>
    schema <span class="op">=</span> example.SchemaDef()
    example.Unmarshal(data, schema)

    <span class="co"># deserialize from Simple Protocol with runtime schema</span>
    example.Deserialize(data, obj, schema, example.ProtocolType.SIMPLE_PROTOCOL)</code></pre></td></tr></table></div>
<h1 id="references">References</h1>
<h2 id="bond-compiler-referencecompiler"><a href="compiler.html">Bond compiler reference</a></h2>
<h2 id="c-users-manualbond_cpp"><a href="bond_cpp.html">C++ User’s Manual</a></h2>
<h2 id="c-users-manualbond_cs"><a href="bond_cs.html">C# User’s Manual</a></h2>
<h2 id="boost-pythonboost_python"><a href="http://www.boost.org/doc/libs/1_54_0/libs/python/doc/index.html">Boost Python</a></h2>
</div>    
</div>
</body>
</html>
